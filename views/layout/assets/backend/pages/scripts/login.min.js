var Login = function() {

    //var globalURLCDMesaGConnection = 'http://www.bibliotecavirtualcarlosdmesa.com/';
    var globalURLCDMesaGConnection = 'http://localhost/www.bibliotecavirtualcarlosdmesa.com/';
    
	var e = function() {
			$(".login-form").validate({
				errorElement: "span",
				errorClass: "help-block",
				focusInvalid: !1,
				rules: {
					username: {
						required: !0
					},
					password: {
						required: !0
					},
					remember: {
						required: !1
					}
				},
				messages: {
					username: {
						required: "Username is required."
					},
					password: {
						required: "Password is required."
					}
				},
				invalidHandler: function(e, r) {
					$(".alert-danger", $(".login-form")).show()
				},
				highlight: function(e) {
					$(e).closest(".form-group").addClass("has-error")
				},
				success: function(e) {
					e.closest(".form-group").removeClass("has-error"), e.remove()
				},
				errorPlacement: function(e, r) {
					e.insertAfter(r.closest(".input-icon"))
				},
				submitHandler: function(e) {
                    
                     var vUserName, vUserCode;
                     $.ajax({
                         type: 'POST',
                         url: globalURLCDMesaGConnection + 'login/access/',
                         data: $(e).serialize(),
                         dataType: 'json',                         
                         success: function (response) {
                             
                            $.each(response, function() {
                                vUserName = response.vUserName;
                                vUserCode = response.vUserCode;
                            });
                            
                             alert(vUserName+' - '+vUserCode);
                             
                            $(e).html("<div id='message'></div>");
                             
                            $('#message').html('<h2>Bienvenido, <strong>'+vUserName+'</strong></h2>')
                                .append('<p>Por favor, espere unos segundos...</p>')
                                .hide()
                                .fadeIn(1000, function () {
                                $('#message').append("<img id='checkmark' src='images/ok.png' />");
                                setTimeout(function(e){
                                    window.location = globalURLCDMesaGConnection + 'admin';
                                    e.preventDefault();
                                },1000);                                
                            });
                         }
                     });
                     return false; // required to block normal submit since you used ajax                        

                }
			}), $(".login-form input").keypress(function(e) {
				return 13 == e.which ? ($(".login-form").validate().form() && $(".login-form").submit(), !1) : void 0
			})
		};    

    
	return {
		init: function() {
			e(), i(), LoginForm()
		}
	}
}();
jQuery(document).ready(function() {
	Login.init()
});

