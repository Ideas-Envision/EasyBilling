var SystemBillingJScripts = function() {

    var globalURLEasyBilling = localStorage.getItem(globalURLEasyBilling);
    
        var ConfirmRegisterBilling = function(){
            
            function validaSoloNumerico(cadena){
                var patron = /^[0-9]+([.][0-9]+)?$/;
                if(!cadena.search(patron))
                  return true;
                else
                  return false;
            }
            
            function validaSoloTexto(cadena){
              var patron = /^[a-zA-Z]*$/;
              // En caso de querer validar cadenas con espacios usar: /^[a-zA-Z\s]*$/
              if(!cadena.search(patron))
                return true;
              else
                return false;
            }
            
            $('#systembilling-form-datainvoice').submit(function(event){
                //alert('enviar form');
                var data = new FormData(this);
                $.ajax({
                    url: globalURLEasyBilling + 'systemBilling/dataBilling/',
                    data: data,
                    processData: false,
                    contentType: false,
                    type: 'POST',
                    beforeSend: function(){
                        //alert('Verificar los datos del video que se registra');
                    },
                    success: function(resultado){
                    alert(resultado);
                       window.location = globalURLEasyBilling + 'systemBilling/' + resultado;
                        /*setTimeout(function(e){
                            window.location = globalURLCDMesaGConnection + 'adminvideostore';
                            e.preventDefault();
                        },3000);*/
                    }
                });
            event.preventDefault();              
            });
        };
    
        var RegisterNewBilling = function(){
            
            $('#btnNewBilling').click(function(event){                
                $.post(globalURLEasyBilling + 'systemBilling/registerNewBilling/', function(dataPostResult) {
                    alert(globalURLEasyBilling + 'systemBilling/newBilling/' + dataPostResult);
                    window.location = globalURLEasyBilling + 'systemBilling/newBilling/' + dataPostResult;
                });
                event.preventDefault();
            });
        };    
    
        var BillingDetailDataInsert = function(){
            
            function validaSoloNumerico(cadena){
                var patron = /^[0-9]+([.][0-9]+)?$/;
                if(!cadena.search(patron))
                  return true;
                else
                  return false;
            }
            
            function validaSoloTexto(cadena){
              var patron = /^[a-zA-Z]*$/;
              // En caso de querer validar cadenas con espacios usar: /^[a-zA-Z\s]*$/
              if(!cadena.search(patron))
                return true;
              else
                return false;
            }            
            
            $('#submitFormDetail').click(function(event){
                var vNumBilling = document.getElementById('vNumBilling').value;
                var vClientName = document.getElementById('vClientName').value;
                var vIDClient = document.getElementById('vIDClient').value;
                var vDateTransactionBilling = document.getElementById('vDateTransactionBilling').value;
                
                if((vClientName == '') || (vClientName == 0) || (vClientName == null)){
                    alert('Debe registrar el nombre del cliente!');
                    return false;
                }
                
                if((vIDClient == '') || (vIDClient == 0) || (vIDClient == null)){
                    alert('Debe registrar el NIT del cliente!');
                    return false;
                }                
                
                var vQuantity = document.getElementById('vQuantity').value;
                var vDetail = document.getElementById('vDetail').value;
                var vAmount = document.getElementById('vAmount').value;
                
                if((vQuantity == '') || (vQuantity == 0) || (vQuantity == null)){
                    alert('Debe registrar la cantidad!');
                    return false;
                }
                
                if((vDetail == '') || (vDetail == 0) || (vDetail == null)){
                    alert('Debe registrar el detalle de la venta!');
                    return false;
                } 
                
                if((vAmount == '') || (vAmount == 0) || (vAmount == null)){
                    alert('Debe registrar el monto de la venta!');
                    return false;
                }
                
                if(validaSoloNumerico(vQuantity) == false){
                    alert('La cantidad ingresada no es válida, por favor ingresa solo números!');
                    return false;                    
                }
                
                if(validaSoloNumerico(vAmount) == false){
                    alert('El monto ingresado no es válido, por favor ingresa solo números!');
                    return false;                    
                }                
                
                $.post(globalURLEasyBilling + 'systemBilling/dataBillingDetails/', {vNumBilling:vNumBilling, vClientName:vClientName, vIDClient:vIDClient, vDateTransactionBilling:vDateTransactionBilling, vQuantity:vQuantity, vDetail:vDetail, vAmount:vAmount}, function(data) {
                    alert(data);
                    window.location = globalURLEasyBilling + 'systemBilling/newBilling/' + data;
                });
                event.preventDefault();
            });
        };
    
        var BillingDetailDelete = function(){           
            
            $('[id^=deleteBillingDetail-]').click(function(event){
                if(confirm('¿Realmente deseas eliminar este registro de la factura?') == true){
                    return true;
                } else {
                    return false;
                }                 
                event.preventDefault();
            });
        };    
    
	return {
		init: function() {
			ConfirmRegisterBilling(), RegisterNewBilling(), BillingDetailDataInsert(), BillingDetailDelete();
		}
	}
}();
jQuery(document).ready(function() {
	SystemBillingJScripts.init()
});